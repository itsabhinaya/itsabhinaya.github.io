<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta http-equiv="Content-Type" content="text/html;">
	<title>Companies that Accept Cryptocurrency</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" type="text/javascript">
	</script>
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
	<script src="https://code.jquery.com/ui/1.10.2/jquery-ui.js" ></script>

	<link rel="stylesheet" href="style.css">


</head>

<body>
	<div class="container">
		<div class="row">
			<div class="col">
				<h1 class="display-1 text-left"><strong>Does</strong></h1>
			</div>
		</div>		
		<div class="row">
			<div class="col-5">

				<div class="ui-widget">
					<h2 class="text-left"> <input type="text" id ="c_name" class="name" onclick="this.focus();this.select()" placeholder="Apple" value="Expedia" autocomplete="on"/></h2>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col">
				<h1 class="display-5 text-left">accept cryptocurrency?</h1>
			</div>
		</div>
		<div class="row">
			<div class="col-3">
				<p class="text-center"><input type="button" class="submit-btn" value="Find here."></p>
			</div>
		</div>
		<div class="row">
			<div class="col">
				<div class="text-left" id="wrap"> </div>
			</div>
		</div>
	</div>

	<script type="text/javascript">

//csv data into an array
$(function() {
	function processData(allText) {
		var allTextLines = allText.split(/\r\n|\n/);
		var lines = [];
		while (allTextLines.length > 0) {
			var entry = {};
			entry = allTextLines.shift().split(',');
			lines.push(entry[0].replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();}));
		}
		$("#c_name").autocomplete({ 
			maxResults: 10,
			source: function(request, response) {
				var results = $.ui.autocomplete.filter(lines, request.term);
				response(results.slice(0, this.options.maxResults));
			},
			select: function(event, ui) { 
				$(event.target).val(ui.item.value);
				callback();}
			});
	}


	var lists = [];

	$.get("crypto.csv", function(data) {
		lists = processData(data);
	});

});

var callback = function() {
	event.preventDefault();
	var nameValue = $("input.name").val().toLowerCase();
	$.get('crypto.csv', function(data) {
		var build = '';
		var type = '';
		var verified = '';
		var check = 0;
		var rows = data.split("\n");

		rows.forEach( function getvalues(thisRow) {

			var columns = thisRow.split(",");
			if (nameValue == columns[0].toLowerCase()) {
				type = columns[3];
				check = 1;
				verified = columns[1].toLowerCase();
			}})
		$('#wrap').html(" "); //clears the div
		nameValue = nameValue.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();})
		type = type.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();})
		if (check == 1 && verified=="yes"){
			build = "<h1>" + nameValue +"* "+" accepts "+" "+ type + "."+ "</h1>";
			build += "<h6>* Verified</h6>";
			$('#wrap').append(build);	
		}else if (check == 1){
			build = "<h1>" + nameValue+" "+" accepts "+" "+ type + "."+ "</h1>";
			$('#wrap').append(build);	
		}else{
			build = "<h1>" +nameValue+" "+" doesn't accept any cryptocurrency." + "</h1>";
			build += "<h6>Let us know if they do accept cryptocurrency curreny here.</h6>"
			$('#wrap').append(build);	
		}
	});
};

$(".submit-btn").click(callback);

$("input").keypress(function() {
	if (event.which == 13) callback();
});

</script>

</body>
</html>